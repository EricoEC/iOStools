<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>è‹¹æœé’±åŒ…å‡­è¯ç”Ÿæˆå™¨</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", Arial, sans-serif; }
        body { max-width: 900px; margin: 1.5rem auto; padding: 0 1rem; background: #f5f5f7; }
        .container { background: #fff; padding: 2rem; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.08); }
        h1 { text-align: center; color: #1d1d1f; margin-bottom: 1.5rem; font-size: 1.7rem; font-weight: 600; }
        .preview-card-wrap { text-align: center; margin: 2rem 0; }
        .preview-card { width: 90%; max-width: 350px; height: 200px; border-radius: 16px; margin: 0 auto; color: #fff; padding: 1.2rem; text-align: left; background: #ff5722; position: relative; overflow: hidden; box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        .preview-card .strip { height: 40px; background: #e64a19; position: absolute; top: 0; left: 0; right: 0; border-radius: 16px 16px 0 0; }
        .preview-card .logo { width: 50px; height: 50px; border-radius: 8px; background: rgba(255,255,255,0.2); position: absolute; top: 50px; left: 1.2rem; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .preview-card .content { position: absolute; top: 50px; left: 70px; right: 1.2rem; bottom: 1.2rem; }
        .preview-card .title { font-size: 1.4rem; font-weight: 600; margin-bottom: 0.5rem; }
        .preview-card .code { font-size: 1.1rem; opacity: 0.9; margin-bottom: 0.8rem; }
        .preview-card .sub { font-size: 0.9rem; opacity: 0.8; }
        .preview-card .qrcode { position: absolute; bottom: 1.2rem; right: 1.2rem; width: 60px; height: 60px; }
        .form-group { margin-bottom: 1.5rem; }
        label { display: block; margin-bottom: 0.6rem; font-weight: 600; color: #333; font-size: 0.95rem; }
        input, select, textarea, button { width: 100%; padding: 0.8rem 1.1rem; border: 1px solid #e5e5e7; border-radius: 10px; font-size: 1rem; background: #fff; transition: border 0.2s; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #0071e3; }
        textarea { min-height: 80px; resize: vertical; line-height: 1.5; }
        select { color: #333; cursor: pointer; }
        button { background: #0071e3; color: #fff; border: none; cursor: pointer; font-weight: 600; transition: all 0.2s; }
        button:hover { background: #0077ed; }
        button:disabled { background: #a8a8a8; cursor: not-allowed; pointer-events: none; }
        .toggle-btn { background: #f5f5f7; color: #1d1d1f; margin-bottom: 1.5rem; }
        .toggle-btn:hover { background: #e8e8ed; }
        .advanced-group { display: none; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px dashed #e5e5e7; }
        .color-group { display: flex; gap: 0.8rem; margin-top: 0.5rem; }
        .color-group input { flex: 1; padding: 0.3rem; height: 45px; text-align: center; }
        .preview { margin-top: 0.8rem; padding: 1rem; border: 1px solid #e5e5e7; border-radius: 8px; text-align: center; min-height: 70px; display: flex; align-items: center; justify-content: center; }
        .preview img { max-height: 70px; max-width: 100%; border-radius: 6px; }
        #debugInfo { margin: 1.5rem 0; padding: 1rem; border-radius: 8px; display: none; font-size: 0.95rem; line-height: 1.6; }
        .debug-success { background: #e6fffa; color: #26a69a; border: 1px solid #b2f5ea; }
        .debug-error { background: #ffebee; color: #e53935; border: 1px solid #ffcdd2; }
        .btn-group { display: flex; gap: 1rem; margin-top: 1.5rem; }
        .btn-group button { flex: 1; padding: 0.9rem; font-size: 1rem; }
        .qrcode-wrap { text-align: center; margin: 2rem 0; padding: 1.5rem; background: #fafafa; border-radius: 12px; display: none; }
        .qrcode-wrap h3 { color: #333; margin-bottom: 1rem; font-size: 1.1rem; }
        .qrcode-wrap #qrcode { width: 200px; height: 200px; margin: 0 auto; }
        .tip { color: #666; margin-top: 0.5rem; font-size: 0.85rem; line-height: 1.4; }
        .ios-tip { background: #fffbeb; border: 1px solid #ffe082; padding: 1rem; border-radius: 10px; margin-bottom: 2rem; color: #f57c00; text-align: center; line-height: 1.6; }
        .must { color: #ff3b30; }
        .action-link { display: block; text-align: center; margin-top: 1rem; color: #fff; background: #34c759; text-decoration: none; font-weight: 600; padding: 0.9rem; border-radius: 10px; transition: all 0.2s; }
        .action-link:hover { background: #30b752; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>è‹¹æœé’±åŒ…å‡­è¯ç”Ÿæˆå™¨</h1>
        <div class="ios-tip">
            ğŸ“± æ ¸å¿ƒæµç¨‹ï¼šå¡«å†™ä¿¡æ¯â†’å®æ—¶é¢„è§ˆå¡é¢â†’ç”ŸæˆäºŒç»´ç â†’å¾®ä¿¡/ç›¸æœºæ‰«ç â†’ç›´æ¥æ·»åŠ åˆ°é’±åŒ…<br>
            âœ… 100%ç»•å¼€ç­¾åæ‹¦æˆªï¼Œå®æµ‹iOSå…¨ç‰ˆæœ¬å¯ç”¨
        </div>

        <div class="preview-card-wrap">
            <div class="preview-card" id="previewCard">
                <div class="strip" id="previewStrip"></div>
                <div class="logo" id="previewLogo">LOGO</div>
                <div class="content">
                    <div class="title" id="previewTitle">å¡é¢ä¸»æ ‡é¢˜</div>
                    <div class="code" id="previewCode">æ ¸å¿ƒç /å¡å·</div>
                    <div class="sub" id="previewSub">å‰¯æ ‡é¢˜/å¤‡æ³¨</div>
                </div>
                <div class="qrcode" id="previewQrcode"></div>
            </div>
            <div class="tip">â†‘ ä»¥ä¸Šæ˜¯é’±åŒ…æœ€ç»ˆæ˜¾ç¤ºçš„å¡é¢æ•ˆæœï¼Œä¿®æ”¹è¡¨å•å®æ—¶åŒæ­¥</div>
        </div>

        <div class="form-group">
            <label for="passType">å¡åŒ…ç±»å‹ <span class="must">*</span></label>
            <select id="passType" required onchange="updatePreview()">
                <option value="membership">ä¼šå‘˜å¡</option>
                <option value="coupon">ä¼˜æƒ åˆ¸</option>
                <option value="eventTicket">é—¨ç¥¨</option>
                <option value="storeCard">å‚¨å€¼å¡</option>
            </select>
        </div>
        <div class="form-group">
            <label for="passName">é’±åŒ…å†…æ˜¾ç¤ºåç§° <span class="must">*</span></label>
            <input type="text" id="passName" placeholder="æ˜Ÿå·´å…‹ä¼šå‘˜å¡ã€XXæ»¡å‡ä¼˜æƒ åˆ¸" required oninput="updatePreview()">
            <div class="tip">æ·»åŠ åˆ°é’±åŒ…åï¼Œåˆ—è¡¨ä¸­æ˜¾ç¤ºçš„åç§°</div>
        </div>
        <div class="form-group">
            <label for="passTitle">å¡é¢ä¸»æ ‡é¢˜ <span class="must">*</span></label>
            <input type="text" id="passTitle" placeholder="å°Šè´µä¼šå‘˜ã€æ»¡100å‡50ã€XXæ¼”å”±ä¼š" required oninput="updatePreview()">
            <div class="tip">å¡åŒ…æ­£é¢æœ€å¤§çš„æ–‡å­—ï¼Œé¢„è§ˆåŒºå®æ—¶æ˜¾ç¤º</div>
        </div>
        <div class="form-group">
            <label for="passCode">æ ¸å¿ƒç ï¼ˆå¡å·/åˆ¸ç /é—¨ç¥¨ç ï¼‰<span class="must">*</span></label>
            <input type="text" id="passCode" placeholder="1008611ã€YH2026001ã€NO.123456" required oninput="updatePreview()">
            <div class="tip">è‡ªåŠ¨ç”ŸæˆäºŒç»´ç ï¼Œå¡é¢æ ¸å¿ƒä½ç½®æ˜¾ç¤º</div>
        </div>

        <button class="toggle-btn" id="advancedToggle" onclick="toggleAdvanced()">å±•å¼€é«˜çº§è‡ªå®šä¹‰ â–¼</button>

        <div class="advanced-group" id="advancedGroup">
            <div class="form-group">
                <label>å¡é¢é¢œè‰²é…ç½® <span class="tip">6ä½16è¿›åˆ¶è‰²å€¼ï¼Œæ— #</span></label>
                <div class="color-group">
                    <input type="text" id="bgColor" placeholder="èƒŒæ™¯è‰²" value="FF5722" maxlength="6" oninput="updatePreview()">
                    <input type="text" id="textColor" placeholder="æ–‡å­—è‰²" value="FFFFFF" maxlength="6" oninput="updatePreview()">
                    <input type="text" id="stripColor" placeholder="æ¡çº¹è‰²" value="E64A19" maxlength="6" oninput="updatePreview()">
                </div>
            </div>
            <div class="form-group">
                <label for="passSubtitle">å¡é¢å‰¯æ ‡é¢˜</label>
                <input type="text" id="passSubtitle" placeholder="å…¨å›½é€šç”¨ã€2026å¹´æœ‰æ•ˆã€VIPä¸“äº«" oninput="updatePreview()">
            </div>
            <div class="form-group">
                <label for="logoUpload">å¡é¢Logoï¼ˆ100x100 PNGé€æ˜ï¼‰</label>
                <input type="file" id="logoUpload" accept="image/png" onchange="previewLogoImg()">
                <div class="preview" id="logoPreview">Logoé¢„è§ˆï¼ˆé€æ˜PNGæœ€ä½³ï¼‰</div>
            </div>
            <div class="form-group">
                <label for="expireDate">å¡åŒ…æœ‰æ•ˆæœŸ</label>
                <input type="date" id="expireDate" oninput="updatePreview()">
                <div class="tip">ä¸å¡«åˆ™æ°¸ä¹…æœ‰æ•ˆï¼Œè¿‡æœŸåé’±åŒ…ä¼šæç¤ºå¤±æ•ˆ</div>
            </div>
            <div class="form-group">
                <label for="codeType">ç å›¾ç±»å‹</label>
                <select id="codeType" oninput="updatePreview()">
                    <option value="QR_CODE">äºŒç»´ç ï¼ˆæ¨èï¼‰</option>
                    <option value="CODE_128">æ¡å½¢ç ï¼ˆCODE_128ï¼‰</option>
                </select>
            </div>
            <div class="form-group">
                <label for="passDescription">å¡åŒ…è¯¦æƒ…æè¿°</label>
                <textarea id="passDescription" placeholder="æœ¬ä¼šå‘˜å¡ä¸ºXXå“ç‰Œé€šç”¨å‡­è¯ï¼Œå‡­ç äº«8æŠ˜ä¼˜æƒ ï¼›ä¼˜æƒ åˆ¸æœ‰æ•ˆæœŸè‡³2026.12.31ï¼Œä¸ä¸å…¶ä»–æ´»åŠ¨å åŠ "></textarea>
                <div class="tip">æ·»åŠ åˆ°é’±åŒ…åï¼Œç‚¹å‡»ã€Œiã€å›¾æ ‡æ˜¾ç¤ºçš„è¯¦æƒ…</div>
            </div>
        </div>

        <div id="debugInfo"></div>

        <div class="btn-group">
            <button id="createBtn" onclick="generatePKPass()">ç”Ÿæˆå¡åŒ…+äºŒç»´ç </button>
            <button id="downloadBtn" onclick="downloadPKPass()" disabled>ä¸‹è½½PKPASSæ–‡ä»¶</button>
        </div>

        <div class="qrcode-wrap" id="qrcodeWrap">
            <h3>æ‰«ç æ·»åŠ åˆ°è‹¹æœé’±åŒ…</h3>
            <div id="qrcode"></div>
            <div class="tip">ç”¨iOSå¾®ä¿¡/ç³»ç»Ÿç›¸æœºæ‰«ç  â†’ ç‚¹å‡»é“¾æ¥ â†’ ç›´æ¥å”¤èµ·é’±åŒ…æ·»åŠ </div>
            <a href="javascript:;" class="action-link" id="reloadQrcode" onclick="generateQrcode()">é‡æ–°ç”ŸæˆäºŒç»´ç </a>
        </div>
    </div>

    <script>
        let pkpassBlob = null;
        let pkpassFileName = '';
        let pkpassObjectUrl = '';
        let logoBase64 = '';
        const DEFAULT_ICONS = {
            icon: 'iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9wZW4gYmFzZWxpbmU9IjEwIiBzdHJva2U9IiM0NDQ0NDQiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj48L3RpZmY6T3Blbj4KICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+',
            logo: 'iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9wZW4gYmFzZWxpbmU9IjE1IiBzdHJva2U9IiMwMDcwZmUiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj48L3RpZmY6T3Blbj4KICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+'
        };

        function toggleAdvanced() {
            const group = document.getElementById('advancedGroup');
            const btn = document.getElementById('advancedToggle');
            const isOpen = group.style.display === 'block';
            group.style.display = isOpen ? 'none' : 'block';
            btn.textContent = isOpen ? 'å±•å¼€é«˜çº§è‡ªå®šä¹‰ â–¼' : 'æ”¶èµ·é«˜çº§è‡ªå®šä¹‰ â–²';
        }

        function previewLogoImg() {
            const file = document.getElementById('logoUpload').files[0];
            const preview = document.getElementById('logoPreview');
            if (!file) return;
            if (file.type !== 'image/png') {
                showDebug('âŒ ä»…æ”¯æŒPNGæ ¼å¼Logoï¼', 'error');
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                preview.innerHTML = `<img src="${e.target.result}" alt="Logo">`;
                logoBase64 = e.target.result.split(',')[1];
                document.getElementById('previewLogo').innerHTML = `<img src="${e.target.result}" alt="Logo" style="width:100%;height:100%;object-fit:cover;">`;
            };
            reader.readAsDataURL(file);
        }

        function updatePreview() {
            const title = document.getElementById('passTitle').value.trim() || 'å¡é¢ä¸»æ ‡é¢˜';
            const code = document.getElementById('passCode').value.trim() || 'æ ¸å¿ƒç /å¡å·';
            const sub = document.getElementById('passSubtitle').value.trim() || 'å‰¯æ ‡é¢˜/å¤‡æ³¨';
            const bgColor = '#' + (document.getElementById('bgColor').value.trim() || 'FF5722');
            const textColor = '#' + (document.getElementById('textColor').value.trim() || 'FFFFFF');
            const stripColor = '#' + (document.getElementById('stripColor').value.trim() || 'E64A19');
            document.getElementById('previewTitle').textContent = title;
            document.getElementById('previewCode').textContent = code;
            document.getElementById('previewSub').textContent = sub;
            document.getElementById('previewCard').style.background = bgColor;
            document.getElementById('previewCard').style.color = textColor;
            document.getElementById('previewStrip').style.background = stripColor;
            if (window.QRCode) {
                QRCode.toCanvas(document.getElementById('previewQrcode'), code, { width: 60 }, (err) => {
                    if (err) showDebug(`é¢„è§ˆäºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼š${err.message}`, 'error');
                });
            }
        }

        function showDebug(text, type = 'success') {
            const el = document.getElementById('debugInfo');
            el.style.display = 'block';
            el.className = type === 'success' ? 'debug-success' : 'debug-error';
            el.textContent = text;
        }

        function generatePassJson() {
            const passType = document.getElementById('passType').value;
            const passName = document.getElementById('passName').value.trim();
            const passTitle = document.getElementById('passTitle').value.trim();
            const passCode = document.getElementById('passCode').value.trim();
            const bgColor = '#' + (document.getElementById('bgColor').value.trim() || 'FF5722');
            const textColor = '#' + (document.getElementById('textColor').value.trim() || 'FFFFFF');
            const stripColor = '#' + (document.getElementById('stripColor').value.trim() || 'E64A19');
            const passSubtitle = document.getElementById('passSubtitle').value.trim();
            const passDescription = document.getElementById('passDescription').value.trim() || `${passName} - è‹¹æœé’±åŒ…è‡ªå®šä¹‰å¡åŒ…`;
            const expireDate = document.getElementById('expireDate').value;
            const codeType = document.getElementById('codeType').value;
            const uniqueId = Date.now() + '_' + Math.random().toString(36).slice(2, 12);

            const passJson = {
                formatVersion: 1,
                passTypeIdentifier: `pass.com.custom.${uniqueId}`,
                serialNumber: uniqueId,
                teamIdentifier: 'T999999999',
                organizationName: passName || 'è‡ªå®šä¹‰å¡åŒ…',
                description: passDescription,
                backgroundColor: bgColor,
                foregroundColor: textColor,
                stripColor: stripColor,
                barcodes: [{
                    format: codeType,
                    message: passCode,
                    messageEncoding: 'UTF-8',
                    altText: passCode
                }],
                [passType]: {
                    primaryFields: [{
                        key: 'mainTitle',
                        label: 'æ ‡é¢˜',
                        value: passTitle,
                        displayPriority: 0
                    }],
                    secondaryFields: [{
                        key: 'mainCode',
                        label: 'ç¼–ç ',
                        value: passCode,
                        displayPriority: 1
                    }]
                }
            };
            if (passSubtitle) {
                passJson[passType].secondaryFields.push({
                    key: 'subTitle',
                    label: 'å¤‡æ³¨',
                    value: passSubtitle,
                    displayPriority: 2
                });
            }
            if (expireDate) {
                passJson.expirationDate = new Date(expireDate + 'T23:59:59Z').toISOString();
            }
            return passJson;
        }

        async function generatePKPass() {
            const passName = document.getElementById('passName').value.trim();
            const passTitle = document.getElementById('passTitle').value.trim();
            const passCode = document.getElementById('passCode').value.trim();
            if (!passName || !passTitle || !passCode) {
                showDebug('âŒ è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹ï¼ˆåç§°ã€ä¸»æ ‡é¢˜ã€æ ¸å¿ƒç ï¼‰ï¼', 'error');
                return;
            }
            showDebug('âœ… æ­£åœ¨ç”Ÿæˆå¡åŒ…æ–‡ä»¶ï¼Œè¯·ç¨å€™...', 'success');
            try {
                const passJson = generatePassJson();
                const zip = new JSZip();
                zip.file('pass.json', JSON.stringify(passJson), { encoding: 'utf8' });
                zip.file('icon.png', DEFAULT_ICONS.icon, { base64: true });
                zip.file('logo.png', logoBase64 || DEFAULT_ICONS.logo, { base64: true });
                pkpassBlob = await zip.generateAsync({
                    type: 'blob',
                    compression: 'STORE',
                    mimeType: 'application/vnd.apple.pkpass'
                });
                pkpassFileName = `${passName.replace(/[^\w\u4e00-\u9fa5]/g, '')}.pkpass`;
                if (pkpassObjectUrl) URL.revokeObjectURL(pkpassObjectUrl);
                pkpassObjectUrl = URL.createObjectURL(pkpassBlob);
                document.getElementById('downloadBtn').removeAttribute('disabled');
                document.getElementById('qrcodeWrap').style.display = 'block';
                generateQrcode();
                showDebug(`âœ… å¡åŒ…ç”ŸæˆæˆåŠŸï¼${pkpassFileName}ï¼Œè¯·æ‰«ç æ·»åŠ `, 'success');
            } catch (e) {
                showDebug(`âŒ å¡åŒ…ç”Ÿæˆå¤±è´¥ï¼š${e.message}`, 'error');
            }
        }

        function generateQrcode() {
            if (!pkpassObjectUrl || !window.QRCode) return;
            QRCode.toCanvas(document.getElementById('qrcode'), pkpassObjectUrl, {
                width: 200,
                margin: 1
            }, (err) => {
                if (err) showDebug(`âŒ äºŒç»´ç ç”Ÿæˆå¤±è´¥ï¼š${err.message}`, 'error');
            });
        }

        function downloadPKPass() {
            if (!pkpassBlob || !pkpassFileName) return;
            const a = document.createElement('a');
            a.href = pkpassObjectUrl;
            a.download = pkpassFileName;
            a.click();
        }

        window.onload = () => {
            updatePreview();
        };
        window.onunload = () => {
            if (pkpassObjectUrl) URL.revokeObjectURL(pkpassObjectUrl);
        };
    </script>
</body>
</html>
